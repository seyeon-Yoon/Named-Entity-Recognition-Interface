# KDPII NER 라벨러

> **🇺🇸 English Version**: See [README.md](./README.md)

## ⚠️ 알려진 이슈

**현재 알려진 이슈 (v3.1.0 기준):**
- 🔄 **라벨 해제 이슈**: 라벨을 해제해도 Entity Labels 패널에 라벨이 그대로 남아있음
- 🔄 **내비게이션**: 태스크 전환을 위한 뒤로 가기 기능이 필요
- 🔄 **내보내기 기능**: 내보내기 기능이 완전히 구현되지 않음
- 📝 **파일 형식**: CSV 파일 처리 지원이 필요
- 🔧 **UI 개선**: 더 나은 사용자 경험을 위한 UI 개선이 필요

> **참고**: 이러한 이슈들은 향후 릴리스에서 해결될 예정입니다. 현재 핵심 기능은 예상대로 작동합니다.

---

🏷️ **KDPII 데이터 처리를 위한 고급 개체명 인식 어노테이션 도구**

파일 업로드 처리, 작업 기반 어노테이션, 색상 일관성 라벨링, 메타데이터 보존, 팀 협업 지원 등의 고급 기능을 포함한 정교한 NER 어노테이션 인터페이스입니다.

## 🚀 빠른 시작

```bash
# 1. 종속성 설치
pip install -r requirements.txt

# 2. 통합 애플리케이션 시작
python3 app.py

# 3. 브라우저 열기
# 메인 주소: http://localhost:8080
# NER 인터페이스: http://localhost:8080/ner
# 팀 협업: http://localhost:8080/collaborate
```

## ✨ 기능

### 핵심 NER 기능
- ✅ **인터랙티브 텍스트 어노테이션** - 클릭 및 드래그로 텍스트 범위 선택
- ✅ **파일 업로드 처리** - 자동 파싱과 함께 JSON, JSONL, TXT 형식 지원
- ✅ **작업 기반 관리** - 접이식 사이드바 내비게이션이 있는 개별 작업
- ✅ **색상 일관성 라벨링** - 업로드 시 라벨별 고정 색상 할당
- ✅ **진정한 중첩 어노테이션** - 고급 중첩 및 겹치는 엔티티 지원
- ✅ **동적 라벨 관리** - 파일에서 자동 생성되는 작업별 라벨

### KDPII 규정 준수 기능
- ✅ **식별자 유형 분류** - 직접/준식별자/기본 식별자 분류
- ✅ **엔티티 관계 연결** - Ctrl+클릭으로 관련 엔티티 연결
- ✅ **메타데이터 보존** - 원본 파일 메타데이터를 읽기 전용 필드에 표시
- ✅ **사용자 인증 시스템** - 다중 사용자 어노테이션 워크플로우
- ✅ **팀 협업** - 워크스페이스 기반 협업 어노테이션

### 고급 UI 기능
- ✅ **메타데이터 표시 패널** - 원본 파일의 읽기 전용 메타데이터
- ✅ **작업 사이드바** - 파일 정보가 있는 접이식 작업 목록
- ✅ **필터 시스템** - 라벨 유형별 어노테이션 숨기기/표시
- ✅ **어노테이션 하이라이팅** - 일관된 색상으로 자동 하이라이팅
- ✅ **파일 업로드 모달** - 형식 지원과 함께 드래그 앤 드롭 인터페이스

### 데이터 처리 및 통합
- ✅ **JSON/JSONL 파서** - 메타데이터 보존과 함께 자동 엔티티 추출
- ✅ **Label Studio 호환** - 가져오기/내보내기 호환성 유지
- ✅ **CoNLL 형식** - 업계 표준 NER 형식 지원
- ✅ **원본 데이터 구조** - 원본 파일 구조 및 메타데이터 보존
- ✅ **팀 워크스페이스** - 멤버 관리가 있는 협업 어노테이션

## 📁 프로젝트 구조

```
kdpii_labler/
├── README.md                    # 이 파일
├── README_KR.md                 # 한국어 README
├── app.py                      # 메인 Flask 애플리케이션 (통합)
├── ner_extractor.py            # 핵심 NER 추출 엔진
├── ner_web_interface.py        # 원본 독립형 NER 인터페이스
├── requirements.txt            # Python 종속성
├── frontend/
│   ├── templates/
│   │   ├── ner_interface.html  # 메인 NER 어노테이션 인터페이스
│   │   ├── collaborate.html    # 팀 협업 페이지
│   │   └── dashboard.html      # 사용자 대시보드
│   └── static/                 # CSS, JavaScript, 이미지
├── backend/
│   ├── config.py              # 애플리케이션 구성
│   ├── database.py            # 데이터베이스 초기화
│   ├── models/                # 데이터 모델
│   ├── services/              # 비즈니스 로직
│   ├── views.py               # 메인 애플리케이션 라우트
│   ├── auth.py                # 인증 시스템
│   ├── api.py                 # REST API 엔드포인트
│   └── collaboration_api.py   # 팀 협업 API
├── docs/                       # 문서
└── tests/                      # 테스트 파일
```

## 🎯 사용 사례

### 1. 파일 기반 일괄 어노테이션
```bash
# 기존 어노테이션이 있는 JSON/JSONL 파일 업로드
# 파일이 자동으로 파싱되어 엔티티와 메타데이터 추출
# 각 텍스트가 보존된 라벨과 색상으로 별도의 작업이 됨
curl -X POST http://localhost:8080/collab/workspaces/workspace_id/upload \
  -F "file=@annotations.jsonl"
```

### 2. 팀 협업 워크플로우
```python
# 팀 어노테이션용 워크스페이스 생성
workspace_id = collab_service.create_workspace("의료 NER 프로젝트")

# 팀 멤버가 워크스페이스에 참여
collab_service.add_member_to_workspace(workspace_id, "annotator_1")

# 작업 업로드 및 협업
POST /collab/workspaces/{workspace_id}/tasks/{task_id}/annotate
{
  "annotations": [...],
  "member_name": "annotator_1"
}
```

### 3. KDPII 개인정보 분류
```json
// 메타데이터 보존이 있는 업로드 파일 예시
{
  "text": "홍길동의 주민번호는 123456-1234567입니다.",
  "entities": [
    {
      "start_offset": 0,
      "end_offset": 3,
      "span_text": "홍길동",
      "entity_type": "PER",
      "identifier_type": "direct"
    }
  ],
  "document_id": "doc_001",
  "source": "medical_records",
  "date": "2024-01-15"
}
```

## 🔧 API 참조

### 주요 애플리케이션 라우트
- **`/ner`** - 메인 NER 어노테이션 인터페이스
- **`/collaborate`** - 팀 협업 워크스페이스
- **`/collab/workspaces`** - 워크스페이스 관리 API
- **`/api/ner/tasks`** - 작업 관리 엔드포인트
- **`/api/ner/tags`** - 라벨 관리 엔드포인트

### 핵심 백엔드 서비스
- **`CollaborationService`** - 팀 워크스페이스 및 작업 관리
- **`NERExtractor`** - 파일 처리가 있는 핵심 어노테이션 엔진
- **`UserService`** - 인증 및 사용자 관리

### 주요 API 엔드포인트
- **`POST /collab/workspaces/{id}/upload`** - 어노테이션용 파일 업로드
- **`GET/POST /api/ner/tasks`** - 작업 생성 및 검색
- **`POST /api/ner/tasks/{id}/annotations`** - 어노테이션 추가
- **`GET /api/ner/tasks/{id}/export`** - 어노테이션 내보내기
- **`GET/POST/PUT/DELETE /api/ner/tags`** - 라벨 CRUD 작업

## 📊 고급 기능 비교

| 기능 | 기본 NER 도구 | KDPII NER 라벨러 v3.1.0 | 상태 |
|------|--------------|------------------------|------|
| 기본 NER 어노테이션 | ✅ | ✅ | **향상됨** |
| 파일 업로드 처리 | ❌ | ✅ | **고급** |
| 작업 기반 관리 | ❌ | ✅ | **독특함** |
| 색상 일관성 라벨링 | ❌ | ✅ | **혁신적** |
| 메타데이터 보존 | ❌ | ✅ | **KDPII 전용** |
| 팀 협업 | ❌ | ✅ | **전문적** |
| 중첩 어노테이션 | ❌ | ✅ | **고급** |
| 엔티티 관계 연결 | ❌ | ✅ | **독특함** |
| 다중 형식 지원 | ❌ | ✅ | **유연함** |
| 워크스페이스 관리 | ❌ | ✅ | **엔터프라이즈** |

## 🧪 테스트

```bash
# 애플리케이션 시작
python3 app.py

# 샘플 데이터로 파일 업로드 테스트
# http://localhost:8080/ner에서 웹 인터페이스를 통해 샘플 JSON/JSONL 파일 업로드

# 협업 기능 테스트
# http://localhost:8080/collaborate에서 워크스페이스 생성

# API 엔드포인트 테스트
curl -X GET http://localhost:8080/api/ner/config
curl -X POST http://localhost:8080/api/ner/tasks -d '{"text":"테스트 어노테이션"}'
```

## 📋 요구사항

- Python 3.8+
- Flask 2.3+
- Flask-SQLAlchemy
- Flask-Login
- 최신 웹 브라우저 (Chrome, Firefox, Safari)
- JavaScript 활성화

## 🔧 주요 기술적 특징

### 파일 처리 엔진
- **다중 형식 파서** - 지능형 JSON/JSONL/TXT 파일 처리
- **메타데이터 추출** - 원본 파일 구조 및 메타데이터 보존
- **엔티티 자동 감지** - 파일에서 자동 엔티티 유형 추출
- **색상 할당** - 업로드 시 라벨별 고정 색상 매핑

### 작업 관리 시스템
- **개별 작업 격리** - 각 텍스트가 독립적인 어노테이션 작업이 됨
- **라벨 범위 지정** - 색상 일관성이 있는 작업별 라벨
- **사이드바 내비게이션** - 파일 정보가 있는 접이식 작업 브라우저
- **상태 지속성** - 작업 상태 및 어노테이션 진행률 유지

### 팀 협업 프레임워크
- **워크스페이스 관리** - 다중 사용자 협업 어노테이션 공간
- **멤버 역할 시스템** - 어노테이터 식별 및 귀속
- **실시간 업데이트** - 충돌 해결이 있는 라이브 협업
- **어노테이션 병합** - 다중 어노테이션 전략 지원

### 고급 UI 아키텍처
- **반응형 디자인** - 다양한 화면 크기에 적응하는 인터페이스
- **인터랙티브 요소** - 드래그 앤 드롭, 모달 대화상자, 동적 양식
- **데이터 시각화** - 실시간 메타데이터 및 어노테이션 표시
- **성능 최적화** - 효율적인 DOM 조작 및 렌더링

## 🤝 기여하기

1. **이슈 보고**: GitHub 이슈를 사용하여 버그 보고 또는 기능 요청
2. **기능 개발**: KDPII 규정 준수 및 개인정보 보호 중심 기능에 집중
3. **코드 품질**: 기존 코드 패턴을 따르고 적절한 테스트 포함
4. **문서화**: 새로운 기능에 대해 README 및 문서 업데이트
5. **협업**: 향상된 팀 협업 기능에 대한 기여 환영

## 📄 라이센스

KDPII 데이터 처리 및 개인정보 보호 규정 준수를 위한 오픈 소스 프로젝트.

## 🔄 버전 히스토리

- **v3.1.0**: 파일 업로드 처리, 작업 관리, 색상 일관성 라벨링, 메타데이터 보존
- **v3.0.0**: 팀 협업과 함께 완전한 코드 통합 및 최적화
- **v2.0.0**: 엔터프라이즈 아키텍처를 갖춘 고급 NER 기능
- **v1.0**: 기본 NER 어노테이션 인터페이스

---

**KDPII 데이터 개인정보 보호를 위해 ❤️로 제작**

*파일 처리, 팀 협업, 메타데이터 보존 기능을 갖춘 고급 NER 어노테이션 도구*